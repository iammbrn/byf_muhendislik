{% extends 'base.html' %}
{% load static %}

{% block title %}Blog - BYF Mühendislik | Mühendislik Haberleri ve İçerikler{% endblock %}

{% block meta_description %}BYF Mühendislik blog sayfası. Elektrik mühendisliği, periyodik kontrol, trafo sistemleri ve mühendislik dünyasından en son haberler ve teknik bilgiler.{% endblock %}

{% block meta_keywords %}mühendislik blog, elektrik mühendisliği, teknik yazılar, mühendislik haberleri, BYF blog{% endblock %}

{% block og_title %}Blog - BYF Mühendislik{% endblock %}
{% block og_description %}Mühendislik dünyasından en son haberler, teknik bilgiler ve uzman görüşleri.{% endblock %}

{% block schema_org %}
{{ block.super }}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Blog",
  "name": "BYF Mühendislik Blog",
  "description": "Elektrik mühendisliği ve ilgili konularda blog yazıları",
  "url": "{{ request.build_absolute_uri }}",
  "publisher": {
    "@type": "Organization",
    "name": "BYF Mühendislik"
  }
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
    "@type": "ListItem",
    "position": 1,
    "name": "Ana Sayfa",
    "item": "{{ request.scheme }}://{{ request.get_host }}"
  },{
    "@type": "ListItem",
    "position": 2,
    "name": "Blog"
  }]
}
</script>
{% endblock schema_org %}

{% block content %}
<!-- Hero Section -->
<section class="page-hero">
    <div class="container">
        <h1>Blog</h1>
        <p>Mühendislik dünyasından en son haberler ve bilgiler</p>
    </div>
</section>

<!-- Blog Content -->
<section class="section-padding">
    <div class="container">
        <div class="blog-container blog-layout">
            <!-- Ana İçerik -->
            <div class="blog-posts">
                {% for post in posts %}
                <article class="blog-post-card">
                    {% if post.featured_image %}
                    <div class="post-image">
                        <img src="{{ post.featured_image.url }}" alt="{{ post.title }} - BYF Mühendislik Blog" loading="lazy" decoding="async" width="800" height="450">
                    </div>
                    {% endif %}
                    
                    <div class="post-content">
                        <div class="post-meta">
                            <span class="post-date">
                                <i class="fas fa-calendar"></i>
                                {{ post.published_at|date:"d M Y" }}
                            </span>
                            <span class="post-author">
                                <i class="fas fa-user"></i>
                                {{ post.author.get_full_name|default:post.author.username }}
                            </span>
                            <span class="post-views">
                                <i class="fas fa-eye"></i>
                                {{ post.views }} görüntülenme
                            </span>
                        </div>

                        <h2 class="post-title">
                            <a href="{% url 'blog_detail' post.slug %}">{{ post.title }}</a>
                        </h2>

                        <div class="post-excerpt">
                            <p>{{ post.excerpt|default:post.content|striptags|truncatewords:30 }}</p>
                        </div>

                        <div class="post-footer">
                            <a href="{% url 'blog_detail' post.slug %}" class="btn btn-primary">
                                Devamını Oku
                                <i class="fas fa-arrow-right"></i>
                            </a>
                        </div>
                    </div>
                </article>
                {% empty %}
                <div class="empty-state">
                    <i class="fas fa-newspaper"></i>
                    <h3>Henüz blog yazısı bulunmuyor</h3>
                    <p>Yakında yeni içeriklerle burada olacağız.</p>
                </div>
                {% endfor %}
            </div>

            <!-- Sidebar -->
            <aside class="blog-sidebar">
                <!-- Arama -->
                <div class="sidebar-widget">
                    <h3>Ara</h3>
                    <form method="get" class="search-form">
                        <div class="input-group">
                            <input type="text" name="q" class="form-control" placeholder="Blogda ara...">
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-search"></i>
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Kategoriler -->
                <div class="sidebar-widget">
                    <h3>Hizmet Kategorileri</h3>
                    <ul class="category-list">
                        <li>
                            <a href="?category=electrical_control">
                                <i class="fas fa-bolt"></i>
                                Elektriksel Periyodik Kontrol
                            </a>
                        </li>
                        <li>
                            <a href="?category=transformer_consultancy">
                                <i class="fas fa-transformer"></i>
                                Trafo Müşavirlik
                            </a>
                        </li>
                        <li>
                            <a href="?category=electrical_design">
                                <i class="fas fa-drafting-compass"></i>
                                Elektrik Proje Çizimi
                            </a>
                        </li>
                    </ul>
                </div>

                <!-- Popüler Yazılar -->
                <div class="sidebar-widget">
                    <h3>Popüler Yazılar</h3>
                    <div class="popular-posts">
                        {% for popular_post in popular_posts %}
                        <div class="popular-post">
                            {% if popular_post.featured_image %}
                            <div class="popular-post-image">
                                <img src="{{ popular_post.featured_image.url }}" alt="{{ popular_post.title }} - BYF Mühendislik" loading="lazy" decoding="async" width="150" height="100">
                            </div>
                            {% endif %}
                            <div class="popular-post-content">
                                <h4>
                                    <a href="{% url 'blog_detail' popular_post.slug %}">
                                        {{ popular_post.title }}
                                    </a>
                                </h4>
                                <span class="post-views">
                                    <i class="fas fa-eye"></i>
                                    {{ popular_post.views }}
                                </span>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>

                <!-- Etiketler -->
                <div class="sidebar-widget">
                    <h3>Etiketler</h3>
                    <div class="tags-cloud">
                        <a href="?tag=elektrik" class="tag">Elektrik</a>
                        <a href="?tag=güvenlik" class="tag">Güvenlik</a>
                        <a href="?tag=periyodik-kontrol" class="tag">Periyodik Kontrol</a>
                        <a href="?tag=trafo" class="tag">Trafo</a>
                        <a href="?tag=proje" class="tag">Proje</a>
                        <a href="?tag=mühendislik" class="tag">Mühendislik</a>
                    </div>
                </div>
            </aside>
        </div>
    </div>
</section>

<style>
/* blog-container grid handled by responsive.css blog-layout class */
.blog-container {
    gap: 1.5rem;
    align-items: start;
}

@media (min-width: 768px) {
    .blog-container {
        gap: 3rem;
    }
}

.blog-posts {
    display: flex;
    flex-direction: column;
    gap: 2rem;
}

.blog-post-card {
    background: var(--white);
    border-radius: var(--border-radius-lg);
    box-shadow: var(--shadow-md);
    overflow: hidden;
    transition: transform 0.3s ease;
}

.blog-post-card:hover {
    transform: translateY(-2px);
}

.post-image {
    height: 250px;
    overflow: hidden;
}

.post-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.3s ease;
}

.blog-post-card:hover .post-image img {
    transform: scale(1.05);
}

.post-content {
    padding: 2rem;
}

.post-meta {
    display: flex;
    gap: 1.5rem;
    margin-bottom: 1rem;
    font-size: 0.9rem;
    color: var(--gray-text);
}

.post-meta i {
    margin-right: 0.5rem;
    color: var(--primary-light);
}

.post-title {
    margin-bottom: 1rem;
}

.post-title a {
    color: var(--dark-text);
    text-decoration: none;
    transition: color 0.3s ease;
}

.post-title a:hover {
    color: var(--primary-light);
}

.post-excerpt {
    margin-bottom: 1.5rem;
    line-height: 1.6;
    color: var(--gray-text);
}

.post-footer {
    display: flex;
    justify-content: flex-end;
}

.blog-sidebar {
    display: flex;
    flex-direction: column;
    gap: 2rem;
}

.sidebar-widget {
    background: var(--white);
    padding: 1.5rem;
    border-radius: var(--border-radius-lg);
    box-shadow: var(--shadow-md);
}

.sidebar-widget h3 {
    margin-bottom: 1rem;
    color: var(--dark-text);
    border-bottom: 2px solid var(--primary-light);
    padding-bottom: 0.5rem;
}

.search-form .input-group {
    display: flex;
}

.search-form .form-control {
    border-right: none;
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
}

.search-form .btn {
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
}

.category-list {
    list-style: none;
    padding: 0;
    margin: 0;
}

.category-list li {
    border-bottom: 1px solid var(--border-color);
}

.category-list li:last-child {
    border-bottom: none;
}

.category-list a {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.75rem 0;
    color: var(--gray-text);
    text-decoration: none;
    transition: color 0.3s ease;
}

.category-list a:hover {
    color: var(--primary-light);
}

.category-list i {
    color: var(--primary-light);
    width: 16px;
}

.popular-posts {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.popular-post {
    display: flex;
    gap: 1rem;
    align-items: flex-start;
}

.popular-post-image {
    width: 60px;
    height: 60px;
    border-radius: 5px;
    overflow: hidden;
    flex-shrink: 0;
}

.popular-post-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.popular-post-content h4 {
    margin: 0 0 0.5rem 0;
    font-size: 0.9rem;
}

.popular-post-content a {
    color: var(--dark-text);
    text-decoration: none;
    transition: color 0.3s ease;
}

.popular-post-content a:hover {
    color: var(--primary-light);
}

.post-views {
    font-size: 0.8rem;
    color: var(--gray-text);
}

.tags-cloud {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
}

.tag {
    background: var(--light-bg);
    color: var(--gray-text);
    padding: 0.25rem 0.75rem;
    border-radius: 15px;
    text-decoration: none;
    font-size: 0.8rem;
    transition: all 0.3s ease;
}

.tag:hover {
    background: var(--primary-light);
    color: white;
}

.empty-state {
    text-align: center;
    padding: 3rem;
    color: var(--gray-text);
    background: var(--white);
    border-radius: var(--border-radius-lg);
    box-shadow: var(--shadow-md);
}

.empty-state i {
    font-size: 4rem;
    margin-bottom: 1rem;
    color: var(--border-color);
}

.empty-state h3 {
    color: var(--dark-text);
}

@media (max-width: 968px) {
    .blog-container {
        grid-template-columns: 1fr;
    }
    
    .blog-sidebar {
        order: -1;
    }
}

@media (max-width: 768px) {
    .post-meta {
        flex-direction: column;
        gap: 0.5rem;
    }
    
    .popular-post {
        flex-direction: column;
    }
    
    .popular-post-image {
        width: 100%;
        height: 120px;
    }
}
</style>
{% endblock %}